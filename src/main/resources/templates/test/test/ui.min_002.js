(function(a){a.widget("pr.widget_meta",{options:{nonce:null,_pid:null,_nonce:null,_translations:{}},_create:function(){this.options._widget_name=this.widgetName.toLowerCase();this.options._widget_class=this.options._widget_name.replace(/_/g,"-");if(typeof this.options._pid==="undefined"||this.options._pid==null){if(typeof pid!=="undefined"){this.options._pid=pid}}if(typeof this.options._nonce==="undefined"||this.options._nonce==null){if(typeof this.element.data("nonce")!=="undefined"){this.options._nonce=this.element.data("nonce")}else{if(typeof this.options.nonce!=="undefined"&&this.options.nonce!=null){this.options._nonce=this.options.nonce}}}if(typeof this.options.ajax_url==="undefined"||this.options.ajax_url==null){if(typeof ajax_url!=="undefined"){this.options.ajax_url=ajax_url;this.options._ajax_url=ajax_url}}if(typeof LocaleTranslations!=="undefined"&&this.options._widget_name in LocaleTranslations){this.options._translations=LocaleTranslations[this.options._widget_name]}this._trigger("_created",null,{context:this})},_trigger:function(b,c,d){a("body").trigger(this.widgetEventPrefix+b,d);return this._super(b,c,d)}});a.widget("pr.widget_form_element",a.pr.widget_meta,{_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){},_render:function(){var b=this;b.element.addClass(b.options._widget_class);b.input=b.element.children(".input").children(":input");b.label=b.input.siblings("label");if(a(b.input).is("select:not(.native)")){a(b.input).widget_select()}b._trigger("_rendered",null,{widget:b})},_listen:function(){var b=this;b.input.on("focusin",function(){b.element.addClass("focus")});b.element.on("focusout",function(){b.element.removeClass("focus")});b.label.on("click",function(){b.input.focus()})}});a.widget("pr.widget_drawer",a.pr.widget_meta,{options:{id:null,source:null,cache:true,position:"right",params:{},title:"",ajax_url:null,overlay_class:"overlay",_widget_prefix:"widget_drawer",_widget_class:"widget-drawer",_is_open:false,_is_scrolling:false,_swipe_threshold:50,_swipe_init:null},_create:function(){var b=this;b._super();b.trigger=b.element;b._override_options();b._create_ui();b._bind_events()},_override_options:function(){var b=this;if(typeof b.trigger.data("drawer-id")!=="undefined"){b.options.id=b.trigger.data("drawer-id")}if(typeof b.trigger.data("drawer-source")!=="undefined"){b.options.source=b.trigger.data("drawer-source")}if(typeof b.trigger.data("drawer-position")!=="undefined"&&a.inArray(b.trigger.data("drawer-position"),["left","right"])>-1){b.options.position=b.trigger.data("drawer-position")}if(typeof b.trigger.data("drawer-cache")!=="undefined"&&b.trigger.data("drawer-cache")=="0"){b.options.cache=false}if(b.options.ajax_url!=null){b.options._ajax_url=b.options.ajax_url}if(typeof b.trigger.data("id")!=="undefined"){b.options.id=b.trigger.data("id")}if(typeof b.trigger.data("source")!=="undefined"){b.options.source=b.trigger.data("source")}if(typeof b.trigger.data("position")!=="undefined"&&a.inArray(b.trigger.data("position"),["left","right"])>-1){b.options.position=b.trigger.data("position")}if(typeof b.trigger.data("cache")!=="undefined"&&b.trigger.data("cache")=="0"){b.options.cache=false}if(typeof b.trigger.data("params")!=="undefined"){b.options.params=b.trigger.data("params")}if(typeof b.trigger.prop("title")!=="undefined"){b.options.title=b.trigger.prop("title")}if(typeof b.trigger.data("title")!=="undefined"){b.options.title=b.trigger.data("title")}return true},_create_ui:function(){var b=this;b.trigger=b.element;b.drawer=a("<div />");b.drawer.addClass(b.options._widget_class).addClass(b.options.position).prop("id","drawer-"+b.options.id).appendTo(a("body"));var c=a("<header />");c.addClass(b.options._widget_class+"-header").appendTo(b.drawer);b.title=a("<div />");b.title.addClass(b.options._widget_class+"-title").appendTo(c);if("title" in b.options&&b.options.title.length){b.title.append("<h3>"+b.options.title+"</h3>")}b.toggle=a("<a />");b.toggle.addClass("toggle").html('<i class="fa fa-times"></i>').appendTo(c);b.content=a("<div />");b.content.addClass(b.options._widget_class+"-content").appendTo(b.drawer);if(!a("."+b.options.overlay_class).length){a("body").append('<div class="'+b.options.overlay_class+'" />')}b.overlay=a("."+b.options.overlay_class);b.overlay.hide();return true},_bind_events:function(){var b=this;b.trigger.on("click",{context:b},b._on_click_trigger);b.toggle.on("click",function(){b._close()});if(typeof Modernizr!=="undefined"&&Modernizr.touch){a(window).on("swipeleft",function(c){if(a(c.target).closest("."+b.options._widget_class+".expanded").length>0&&b.options.position=="left"){b._close()}});a(window).on("swiperight",function(c){if(a(c.target).closest("."+b.options._widget_class).length>0){b._scroll("left")}})}b.overlay.on("click",function(){if(b.options._is_open&&b.overlay.data("trigger")==b.options._widget_prefix){b._close()}})},_on_click_trigger:function(c){c.stopPropagation();var b=c.data.context;if(b.options._is_open){b._close();return true}if(!b.options.id.length||!b.options.source.length){return false}if(!b.content.html().length||!b.options.cache){a.when(b._load()).done(function(){b._trigger("_loaded",null,{context:b});b._trigger("_loaded_"+b.options.id.replace("-","_"),null,{context:b});b._open()})}else{b._open()}},_on_tapmove_drawer:function(f,g){var c=f.data.context;if(c.options._is_scrolling){return false}if(!c.options._is_open){return false}if(c.options._swipe_init==null){c.options._swipe_init=g.position.x}var b=c.options.position=="left"?g.position.x-c.options._swipe_init:c.options._swipe_init-g.position.x;if(b>=0){return false}var d={};d[c.options.position]=b+"px";c.drawer.css(d);return true},_on_tapend_drawer:function(c,d){var b=c.data.context;if(b.options._swipe_init==null){return}if(b.options.position=="left"&&d.position.x<=b.options._swipe_init-b.options._swipe_threshold){b._close();return true}if(b.options.position=="right"&&d.position.x>=b.options._swipe_init+b.options._swipe_threshold){b._close();return true}b._slide_open();return true},_load:function(){var b=this,g=a.Deferred();if(!b.options.cache){b.drawer.empty()}if(b.options.source.indexOf("#")==-1){var f=a.extend({action:b.options.source,pid:b.options._pid},b.options.params);var e=a.ajax({url:b.options._ajax_url,method:"post",dataType:"json",data:f});e.done(function(d){if(d.success){if("content" in d&&d.content.length){b.content.html(d.content)}if("title" in d&&d.title.length){b.title.html(d.title)}g.resolve()}else{g.reject()}});e.fail(function(){g.reject()})}else{if(a(b.options.source).length){var c=a(b.options.source).html();b.content.append(c);g.resolve()}else{g.reject()}}return g.promise()},_slide_open:function(){var c=this,b={};c.options._swipe_init=null;b[c.options.position]="0px";var e=c.drawer.animate(b,"fast");return e.promise()},_slide_close:function(){var c=this,b={};c.options._swipe_init=null;b[c.options.position]="-"+c.drawer.outerWidth()+"px";var e=c.drawer.animate(b,"fast");return e.promise()},_open:function(){var b=this;if(b._trigger("_before_open",null,{context:b})===false){return false}if(b._trigger("_before_open_"+b.options.id.replace("-","_"),null,{context:b})===false){return false}var d=b.options.position=="left"?{left:"-"+b.drawer.outerWidth()+"px",right:"auto"}:{left:"auto",right:"-"+b.drawer.outerWidth()+"px"};b.drawer.css(d).addClass("expanded");var c=b.overlay.data("trigger",b.options._widget_prefix).fadeIn("fast");a.when(b._slide_open(),c).done(function(){b.options._is_open=true;b._trigger("_opened",null,{context:b});b._trigger("_opened_"+b.options.id.replace("-","_"),null,{context:b})});return true},_close:function(){var b=this;if(b._trigger("_before_close",null,{context:b})===false){return false}if(b._trigger("_before_close_"+b.options.id.replace("-","_"),null,{context:b})===false){return false}var c=b.overlay.data("trigger",null).fadeOut("fast");a.when(b._slide_close(),c).done(function(){b.options._is_open=false;b.drawer.removeClass("expanded");b._trigger("_closed",null,{context:b});b._trigger("_closed_"+b.options.id.replace("-","_"),null,{context:b})});return true}});a.widget("pr.widget_expandable_menu",{options:{},_create:function(){this.menu=this.element;this._create_ui();this._bind_events()},_create_ui:function(){this.menu.children("li").each(function(){var c=a(this);if(c.hasClass("current")||c.hasClass("has-current")){c.addClass("expanded")}if(c.find("ul").length){var d=a(this).children("a"),b=a('<div class="toggle" />');b.append('<i class="fa fa-caret-down" />').appendTo(d)}})},_bind_events:function(){this.menu.on("click",".toggle",{context:this},function(g){g.preventDefault();var d=g.data.context,c=a(this),b=c.closest("li"),f=b.find("ul");if(b.hasClass("expanded")){f.slideUp("fast");b.removeClass("expanded")}else{b.addClass("expanded");f.slideDown("fast")}})}});a.widget("pr.widget_search_button",{options:{button_class:"button",input_class:"input",input_width:"240px",input_name:"search",autocomplete:true,_widget_class:"widget-search"},_create:function(){this._override_options();this._create_ui();this._bind_events()},_override_options:function(){},_create_ui:function(){this.button=this.element;this.button.addClass(this.options.button_class);this.container=a("<div />");this.container.addClass(this.options._widget_class).appendTo(this.button.parent()).append(this.button);this.form=a("<form />");this.form.appendTo(this.container);this.input=a('<input type="text" name="'+this.options.input_name+'"/>');this.input.addClass(this.options.input_class).appendTo(this.form).css({opacity:0,width:this.button.outerWidth()});if(this.options.autocomplete){this.input.prop("autocomplete","off")}},_bind_events:function(){this.button.on("click",{context:this},this._on_click_button)},_on_click_button:function(c){c.preventDefault();var b=c.data.context;if(b.element.data("expanded")){if(!b.input.val().length){b._collapse()}else{b._submit()}}else{b._expand()}},_expand:function(){var b=this;if(b._trigger("_before_expand",null,{widget:b})===false){return false}b.input.animate({opacity:1,width:this.options.input_width},"fast",function(){b.container.addClass("expanded");b.input.focus();b._trigger("_expanded",null,{widget:b})});this.element.data("expanded",true)},_collapse:function(){var b=this;if(b._trigger("_before_collapse",null,{widget:b})===false){return false}b.input.animate({opacity:0,width:this.button.outerWidth()},"fast",function(){b.container.removeClass("expanded");b.input.blur();b._trigger("_collapsed",null,{widget:b})});this.element.data("expanded",false)},_submit:function(){this.form.submit()}});a.widget("pr.widget_status",a.pr.widget_meta,{options:{icons:{pending:"fa-spinner fa-spin",success:"fa-check",error:"fa-times",info:"fa-exclamation-circle"},_widget_class:"widget-status",_message_class:"message",_icon_class:"fa",_container_offset:"60px",_timeout:5000,_status_queued:function(d,c){var b=c.context;if(!b._progress){b._start()}},_status_showing:function(d,c){var b=c.context;b._wait()},_status_resolved:function(d,c){var b=c.context;b._finish()},_status_complete:function(d,c){var b=c.context;if(b._queue.length){b._start()}}},_create:function(){this._super();this._queue=[];this._progress=false;this._status=false;this._create_ui();this._setup();this._bind_events()},_create_ui:function(){this.container=a("<div />");this.container.addClass(this.options._widget_class).appendTo(this.element);this.message=a("<div />");this.message.addClass(this.options._message_class).appendTo(this.container);this.icon=a("<i />");this.icon.addClass(this.options._icon_class).appendTo(this.message).wrap('<div class="icon"></div>');this.text=a("<div />");this.text.addClass("text").appendTo(this.message)},_setup:function(){this.element.data("widget_status",true);this.container.css({bottom:"-"+this.options._container_offset})},_bind_events:function(){var b=this;a(document).ajaxSend(function(f,g,e){if(b._progress){b._resolve()}b._is_ajax=true;var d=false;if("data" in e){var c=decodeURI(e.data);d=c.match("(_background=true)")}if(!d){setTimeout(function(){if(b._is_ajax&&!b._progress&&!b._queue.length){b.queue("pending")}},1000)}});a(document).ajaxComplete(function(){b._is_ajax=false;setTimeout(function(){if(!b._is_ajax&&b._progress&&b._status.status=="pending"){b._resolve()}},1000)})},queue:function(b,g,e,h){var c=this;if(c._queue.length>1){var d=c._queue[c._queue.length-1];if(d.status=="pending"){c._queue.pop()}}if(c._progress&&c._status.status=="pending"){c._resolve()}var f={status:b,text:g,icon:e,auto:h};c._queue.push(f);c._trigger("_status_queued",null,{context:c,status:f})},_start:function(){var c=this,b=c._queue[0];c._progress=true;c._status=b;c._format(b);c.container.animate({bottom:c.options._container_offset},"fast",function(){c._trigger("_status_showing",null,{context:c,status:b})})},_finish:function(){var c=this,b=c._status;c.container.animate({bottom:"-"+c.options._container_offset},"fast",function(){c._progress=false;c._queue.shift();c._trigger("_status_complete",null,{context:c,status:b})})},_wait:function(){var b=this;if(b._status.auto){var c=a.isNumeric(b._status.auto)?b._status.auto:b.options._timeout;setTimeout(function(){b._resolve()},c)}},_resolve:function(){var b=this;b._trigger("_status_resolved",null,{context:b,status:b._status})},_format:function(c){var b=this;status=c.status;text=typeof c.text!=="undefined"&&c.text!==null?c.text:b.options._translations[status];icon=typeof c.icon!=="undefined"&&c.icon!==null?c.icon:b.options.icons[status];b.message.removeAttr("class").addClass(b.options._message_class+" "+status);b.icon.removeAttr("class").addClass(b.options._icon_class+" "+icon);b.text.html(text)}});a.widget("pr.widget_scroll",{_create:function(){this._create_ui();this._bind_events()},_create_ui:function(){var b=this;b.element.data("widget_scroll",true)},_bind_events:function(){var b=this;a(window).on("load",function(d){d.preventDefault();var c=window.location.hash;if(typeof c!=="undefined"&&a(c).length){setTimeout(function(){b.scroll(a(c))},1)}})},scroll:function(c){if(!a(c).length){return false}if(!a(c).is(":visible")){a(c).show()}var b=a("#navbar").outerHeight(),d=a(c).offset().top;a("html, body").animate({scrollTop:d-b-12+"px"},"fast")}});a.widget("pr.widget_trim",a.pr.widget_meta,{options:{length:250,buffer:50,_text:{expand:"Show more",collapse:"Show less"}},_create:function(){this._super();this._override();if(this._trim()){this._render();this._listen()}},_override:function(){var b=this;if(typeof b.element.data("trim")!=="undefined"&&parseInt(b.element.data("trim"))>0){b.options.length=b.element.data("trim")}if(typeof b.element.data("trim-buffer")!=="undefined"&&parseInt(b.element.data("trim-buffer"))>0){this.options.buffer=this.element.data("trim-buffer")}b.options._text=a.extend(b.options._text,b.options._translations)},_render:function(){var b=this;b._expanded=false;b.toggle=a("<a />");b.toggle.text(b.options._text.expand).addClass("text-secondary").appendTo(this.element).wrapAll("<p></p>");b.trimmed=b.element.find(".trimmed");b.ellipsis=b.element.find("[data-ellipsis]")},_listen:function(){var b=this;b.toggle.on("click",function(){if(!b._expanded){b.ellipsis.hide();b.trimmed.show();a(this).text(b.options._text.collapse);b._expanded=true}else{b.ellipsis.show();b.trimmed.hide();a(this).text(b.options._text.expand);b._expanded=false}})},_trim:function(){var b=this,e=0,d=false,c=b.element.find("p");c.each(function(h){var k=a(this);if(d||e>=b.options.length){a(this).nextAll().addBack().addClass("trimmed").hide();d=true;return false}else{var f=a(this).text().length;if(e+f>b.options.length){if(e+f<=b.options.length+b.options.buffer){if(k.nextAll().length){k.nextAll().addClass("trimmed").hide();d=true}}else{var n=k.text(),m=f-((e+f)-b.options.length),g=n.slice(0,m).lastIndexOf(" ");if(m<b.options.buffer){a(this).nextAll().addBack().addClass("trimmed").hide();d=true}else{var l=a("<span />");l.html(n.slice(0,g)+'<span data-ellipsis="1">...</span>');var j=a("<span />");j.addClass("trimmed").hide().html(n.slice(g));a(this).empty().append(l).append(j);d=true}}}e+=f}});return d}});a.widget("pr.widget_device",a.pr.widget_meta,{options:{_device:null,_devices:["mobile_narrow","mobile_medium","mobile_wide","desktop_narrow","desktop_medium","desktop_wide"]},_create:function(){this._super();this._create_ui();this._bind_events();this._update()},_create_ui:function(){var c=this,b=c.options._devices;this.container=a("<div />");this.container.prop("id",this.options._widget_class).appendTo(this.element);c.options._device_order={};a.each(b,function(e,g){c.options._device_order[g]=e;g=g.replace("_","-");var f=a("<div />");f.prop("id",c.options._widget_class+"-"+g).data("device",g).appendTo(c.container)})},_bind_events:function(){a(window).on("resize",{context:this},this._on_resize_window)},_on_resize_window:function(c){var b=c.data.context;b._update()},_update:function(){var b=this;b.container.children("div").each(function(c){if(a(this).css("visibility")=="visible"){var d=a(this).data("device");d=d.replace("-","_");if(typeof b.options._device==null||(typeof b.options._device!=null&&b.options._device!=d)){b._trigger("_changed",null,{context:b,current:d,previous:b.options._device});b._trigger("_changed_to_"+d,null,{context:b,previous:b.options._device});b._trigger("_changed_to_"+d+"_from_"+b.options._device,null,{context:b});var f=b.options._device_order[d]>b.options._device_order[b.options._device]?"scale_up":"scale_down";b._trigger("_"+f,null,{context:b,current:d,previous:b.options._device})}b.options._device=d}})},get_device:function(){var b=this;b._update();return b.options._device},is_device:function(d,g){var c=this,b=c.options._devices;g=typeof g!=="undefined"?g:"=";g=a.inArray(g,[">",">=","<","<=","="])>-1?g:"=";c._update();var e=c.get_device(),f={">":function(j,h){return j>h},">=":function(j,h){return j>=h},"<":function(j,h){return j<h},"<=":function(j,h){return j<=h},"=":function(j,h){return j==h}};return f[g](b.indexOf(e),b.indexOf(d))}});a.widget("pr.widget_tabs",a.pr.widget_meta,{options:{},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this},_render:function(){var b=this;b.container=b.element;b.container.addClass(b.options._widget_class);b.tabs=b.container.children(".tabs");b.panes=b.container.children(".panes")},_listen:function(){var b=this;b.tabs.on("click",".tab",function(d){d.preventDefault();var c=a(this).data("target");b._switch(c)})},_switch:function(d){var b=this,c=b.tabs.find('[data-target="'+d+'"]'),e=b.panes.find('[data-context="'+d+'"]');if(c.hasClass("selected")){return}b.tabs.find(".tab").removeClass("selected");b.panes.find(".pane").removeClass("selected");c.addClass("selected");e.addClass("selected");b._trigger("_switched",null,{context:b,target:d})},switch_tabs:function(c){var b=this;b._switch(c)}});a.widget("pr.widget_carousel",a.pr.widget_meta,{options:{},_create:function(){this._super();this._override();this._render();this._listen();this._calibrate();this._update_ui(0)},_override:function(){var b=this},_render:function(){var b=this;b.prev=a('<button class="btn btn-fixed btn-primary prev"><i class="fa fa-chevron-left"></i></button>');b.next=a('<button class="btn btn-fixed btn-primary next"><i class="fa fa-chevron-right"></i></button>');b.container=b.element;b.container.addClass(b.options._widget_class).append(b.prev).append(b.next);b.list=b.element.find("ul");b.list.addClass("list")},_listen:function(){var b=this;a(window).on("resize",function(c){b._calibrate();b.list.css("transform","translate3d(0px,0px,0px)");b._update_ui(0)});b.next.on("click",function(c){c.preventDefault();b._scroll("right")});b.prev.on("click",function(c){c.preventDefault();b._scroll("left")})},_calibrate:function(){var b=this,f=b.list.children().first(),d=b.list.children().last(),e=f.offset().left,c=d.offset().left+d.outerWidth();b.total_width=c-e;b.visible_width=b.list.width();b.min_offset=-(b.total_width-b.visible_width)},_get_offset:function(){var d=this,c=d.list.css("transform").replace(/[^0-9\-.,]/g,"").split(",");var b=c[12]||c[4];return parseFloat(b)},_get_clamped:function(e){var c=this,b=0,d=c.min_offset;if(e<d){e=d}else{if(e>b){e=b}}return parseFloat(e)},_closest_item_x:function(c,k){var l=this,e=l.list.children().first(),f=l.list.children().filter(":nth-child(2)"),h=e.width(),j=f.offset().left-e.offset().left-h,b=Math.abs(c)/(h+j);var d=k===1?Math.floor(b):Math.ceil(b),g=0-d*(h+j);return g},_scroll:function(d){var c=this,b=c._get_offset(),g;if(d=="left"){g=-1}else{if(d=="right"){g=1}}var e=b+(-c.visible_width*g),f=c._get_clamped(e);e=(e===f)?c._closest_item_x(e,g):f;c.list.css("transform","translate3d("+e+"px,0px,0px)");c._update_ui(e)},_update_ui:function(c){var b=this;b.prev.show();b.next.show();if(c>=0){b.prev.hide()}if(c<=b._get_clamped(b.min_offset)){b.next.hide()}}});a.widget("pr.widget_contents_nav",a.pr.widget_meta,{options:{source:null,depth:3},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this;if(typeof b.element.data("source")!=="undefined"){b.options.source=b.element.data("source")}if(typeof b.element.data("depth")!=="undefined"){b.options.depth=b.element.data("depth")}},_render:function(){var b=this;b.element.addClass(b.options._widget_class).prop("id",b.options._widget_class+"-container");b.source=a(b.options.source);b.list=a("<ul />");b.list.appendTo(b.element);var c=b._get_tags();if(c.length<1){return false}b.source.find(c.join()).each(function(g,e){var j=a(e),f=j.prop("tagName"),k=b.uuid+""+g,h='<a data-target="'+k+'">'+j.text()+"</a>",d='<li class="'+f.toLowerCase()+'">'+h+"</li>";j.prop("id",b.options._widget_class+"-"+k);b.list.append(d)});b.fab=a("#contents-drawer-toggle");b.fab.widget_drawer({id:b.options._widget_class+"-drawer",source:"#"+b.options._widget_class+"-container"}).on("widget_drawer_opened",function(h,g){var f=g.context,d=f.drawer;d.on("click","a",function(k){k.preventDefault();var l=a(this).data("target"),j="#"+b.options._widget_class+"-"+l;a.scroll_to(j);f._close()})})},_listen:function(){var b=this;b.element.on("click","a",function(){var d=a(this).data("target"),c="#"+b.options._widget_class+"-"+d;a.scroll_to(c)});a("body").on("widget_device_changed",function(d,c){});a("body").on("widget_fab_clicked",function(d,c){})},_get_tags:function(){var b=this,d,c=[];for(i=1;i<=6;i++){if(b.source.find("h"+i).length){d=i;break}}for(i=d;i<d+b.options.depth;i++){c.push("h"+i)}return c}});a.widget("pr.widget_static_sidebar",a.pr.widget_meta,{options:{limit_top:null,limit_bottom:null,navbar_fixed:true,margin:24},_create:function(){if(this.element.find(".static").length>0){this._super();this._override();this._render();this._listen()}},_override:function(){var b=this},_render:function(){var b=this;b.container=a("<div />");b.container.addClass(b.options._widget_class).appendTo(b.element).css({position:"relative","padding-top":b.options.margin}).append(b.element.children(".static"));b._is_static=false;b._update()},_listen:function(){var b=this;a(window).on("load resize",function(){b._container_height=b.container.outerHeight();b._offset_top=a("#navbar").outerHeight();b.container.css("margin-top",0);b._is_static=false});a(window).on("load scroll resize",function(){if(a.is_device("mobile_wide",">=")){b._update()}})},_update:function(){var c=this,b=a(window).scrollTop();if(!c._is_static){c._limit_top=c.container.offset().top;c._limit_bottom=c.element.parent().offset().top+c.element.parent().outerHeight()}if(b+c._offset_top>=c._limit_top){c._is_static=true;var d;if(b+c._offset_top+c._container_height>=c._limit_bottom){d=c._limit_bottom-c._container_height-c._limit_top}else{d=b-c._limit_top+c._offset_top}}else{d=0}c.container.css("margin-top",d);c._previous_top=d}});a.widget("pr.ui_list_navigator",a.pr.widget_meta,{options:{append_to:null,_append_to:null,_selected:null},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this,d;if(typeof b.element.data("append-to")!=="undefined"){d=b.element.data("append-to")}else{if(b.options.append_to!=null){d=b.options.append_to}}b.options._append_to=typeof d!=="undefined"?(typeof d=="string"?a(d):d):b.element.parent();if(typeof b.element.data("types")!=="undefined"){var c=b.element.data("types");c=typeof c!="string"?c.join():c;b.options.types=c}},_render:function(){var b=this;b._has_focus=false;b.parent=b.options._append_to;b.container=b.element;b.container.addClass(b.options._widget_class);b.list=a("<ul />");b.list.addClass(b.options._widget_class+"-list").appendTo(b.container)},_listen:function(){var b=this;b.list.on("mouseover","li",function(c){b.list.children().removeClass("hover selected");if(!a(this).hasClass("not-selectable")){a(this).addClass("hover")}});b.list.on("mouseleave","li",function(c){a(this).removeClass("hover")});b.list.on("click","li",function(c){b.select(a(this))});a(document).on("keydown",function(d){if(b._has_focus){switch(d.which){case 38:d.preventDefault();b._navigate("prev");break;case 40:d.preventDefault();b._navigate("next");break;case 13:d.preventDefault();var c=b.list.find(".selected");if(c.length){b.select(c)}break;case 27:d.preventDefault();b.set_focus(false);b.list.find(".selected").removeClass("selected");break;default:return}}})},_navigate:function(f){var c=this,b=c.list.children(),e=b.filter(".selected"),d;if(b.length){switch(f){case"prev":if(e.length){if(!e.is(":first-child")){d=e.prevAll().not(".not-selectable").first()}else{c._trigger("_list_beginning_reached",null,{context:c})}}else{d=b.last()}break;case"next":if(e.length){if(!e.is(":last-child")){d=e.nextAll().not(".not-selectable").first()}else{c._trigger("_list_end_reached",null,{context:c})}}else{d=b.not(".not-selectable").first()}break;case"none":d=null;break}}b.removeClass("selected");if(typeof d!=="undefined"){d.addClass("selected");c._trigger("_list_navigated",null,{context:c,item:d})}},render:function(d,c){var b=this;if(d==null){return false}a.each(d,function(f,g){if(!"items" in g||typeof g.items==="undefined"||!a.isArray(g.items)){return true}if("title" in g){var e=a("<li />");e.addClass("group-item not-selectable").html("<span>"+g.title+"</span>").appendTo(b.list)}a.each(g.items,function(j,l){var h=a("<li />");if("icon" in l){h.addClass("has-icon").append('<div><i class="'+l.icon+'"></i></div>')}if("image" in l){h.addClass("has-image").append('<div><img src="'+l.image+'" /></div>')}if("title" in l){var k=new RegExp(c,"gi"),m=l.title.replace(k,function(n){return"<b>"+n+"</b>"});h.append("<h5>"+m+"</h5>")}if("description" in l){h.append("<p>"+l.description+"</p>")}h.data(l).appendTo(b.list);b._trigger("_item_rendered",null,{context:b})});b._trigger("_group_rendered",null,{context:b})});b._trigger("_items_rendered",null,{context:b});return true},set_focus:function(c){var b=this;c=typeof c=="boolean"?c:false;b._has_focus=c;b._trigger("_list_focus",null,{context:b,focus:b._has_focus})},get_focus:function(){var b=this;return b._has_focus},select:function(c){var b=this;b.options._selected=c;b.list.find(".selected").removeClass("selected");c.addClass("selected");b._trigger("_item_selected",null,{context:b,selected:c})},get_selected:function(){var b=this;if(typeof b.options._selected!=="undefined"&&b.options._selected!=null){return b.options._selected}return false}});a.widget("pr.widget_search",a.pr.widget_meta,{options:{types:[],proxy:"search",id:null,params:null,append_results:null,_append_results:null,_result_accepted:function(d,c){var b=c.context;if(b._accepted_result==null){return false}if(typeof b._accepted_result.data("url")==="undefined"){return false}window.open(b._accepted_result.data("url"),"_self")}},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this;if(b.options.id==null){b.options._id=b.element.prop("name")}else{b.options._id=b.options.id}var d;if(typeof b.element.data("append-results")!=="undefined"){d=b.element.data("append-results")}else{if(b.options.append_results!=null){d=b.options.append_results}}if(typeof b.element.data("types")!=="undefined"){var c=b.element.data("types");c=typeof c!="string"?c.join():c;b.options.types=c}b.options._append_results=typeof d!=="undefined"?(typeof d=="string"?a(d):d):b.element.parent()},_render:function(){var b=this;b._term=null;b._cached_results={};b._accepted_result=null;b._is_showing=false;b._is_progress=false;b.element.addClass(b.options._widget_class);b.form=b.element.closest("form");b.suggestions=a("<div />");b.suggestions.addClass(b.options._widget_class+"-suggestions").appendTo(b.options._append_results);b.message=a("<p />");b.message.addClass(b.options._widget_class+"-message").appendTo(b.suggestions);b.results=a("<ul />");b.results.addClass(b.options._widget_class+"-results").appendTo(b.suggestions)},_listen:function(){var c=this;var d,b=200;c.element.on("keyup paste",function(g){var f=[13,27,37,38,39,40];if((a.inArray(g.which,f))>=0||g.ctrlKey){return}clearTimeout(d);d=setTimeout(function(){c._term=c.element.val();if(c._term.length>0){c._get_results().done(function(){c._render_results().done(function(){c.suggestions.show();c._is_showing=true}).fail(function(){c.suggestions.show();c._is_showing=true})})}else{c.suggestions.hide();c._is_showing=false}},b)});c.element.on("keydown",function(f){clearTimeout(d)});c.element.on("focus",function(f){c._term=c.element.val();if(c._term.length>0){c._get_results().done(function(){c._render_results().done(function(){c.suggestions.show();c._is_showing=true})})}});c.results.on("mouseover","li",function(f){c.results.children().removeClass("hover selected");if(!a(this).hasClass(c.options._widget_class+"-results-title")){a(this).addClass("hover")}});c.results.on("mouseleave","li",function(f){a(this).removeClass("hover")});c.results.on("click","li",function(f){c._accept_result(a(this))});a(document).on("mouseup",function(f){if(c.options.append_results==null){if(c._is_showing&&f.target!==c.element[0]&&f.target!==c.suggestions[0]&&!a.contains(c.element[0],f.target)&&!a.contains(c.suggestions[0],f.target)){c.suggestions.hide();c._is_showing=false}}});a(document).on("keydown",{context:c},function(g){if(c._is_showing){switch(g.which){case 38:g.preventDefault();c._select_result("prev");break;case 40:g.preventDefault();c._select_result("next");break;case 13:g.preventDefault();var f=c.results.find(".selected");if(f.length){c._accept_result(f)}break;case 27:g.preventDefault();c.element.blur();c.suggestions.hide();c._is_showing=false;break;default:return}}})},_get_results:function(){var b=this,g=a.Deferred(),c=a.trim(b.element.val());if(b._term==b._cached_results.term){g.resolve()}else{b._trigger("_before_get_results",null,{context:b});var f={action:"suggestion_results",nonce:b.options._nonce,pid:b.options._pid,id:b.options._id,proxy:b.options.proxy,term:c,types:b.options.types};if(b.options.params!=null){f.params=b.options.params}var e=a.ajax({url:b.options.ajax_url,method:"post",dataType:"json",data:f});e.done(function(d){b._cached_results=d;b._cached_results.term=b._term;g.resolve()})}return g.promise()},_render_results:function(){var b=this,e=a.Deferred(),c=b._cached_results;b.results.empty();b.message.text("");if(c.success&&"results" in c){a.each(c.results,function(d,f){if(typeof f.label!=="undefined"){var g=a("<li />");g.addClass(b.options._widget_class+"-results-title").html("<span>"+f.label+"</span>").appendTo(b.results)}a.each(f.suggestions,function(h,m){var l=a("<li />");if("icon" in m&&m.icon!=false){l.addClass("has-icon").append("<div>"+m.icon+"</div>")}if("title" in m){var j=new RegExp(b.element.val(),"gi"),n=m.title.replace(j,function(o){return"<b>"+o+"</b>"});l.append("<h5>"+n+"</h5>")}if("description" in m&&m.description!=null){var j=new RegExp(b.element.val(),"gi"),k=m.description.replace(j,function(o){return"<b>"+o+"</b>"});l.append("<p>"+k+"</p>")}l.data(m).appendTo(b.results)})});b._select_result("next");e.resolve()}else{b.message.text(c.message);e.reject()}return e.promise()},_select_result:function(g){var c=this,b=c.results.children(),f=b.filter(".selected"),d;if(b.length){switch(g){case"prev":if(f.length){if(!f.is(":first-child")){d=f.prevAll().not("."+c.options._widget_class+"-results-title").first()}else{d=b.last()}}else{d=b.last()}break;case"next":if(f.length){if(!f.is(":last-child")){d=f.nextAll().not("."+c.options._widget_class+"-results-title").first()}else{c.element.focus()}}else{d=b.first()}break;case"none":d=null;break}}b.removeClass("selected");if(typeof d!=="undefined"){d.addClass("selected");var e=d.prev().hasClass(c.options._widget_class+"-results-title")?d.prev():d;c._scroll_suggestions(e)}},_accept_result:function(b){var c=this;c._accepted_result=b;c._trigger("_result_accepted",null,{context:c})},_scroll_suggestions:function(f){var d=this;if(typeof f!=="undefined"){var c=f.outerHeight(),b=f.position().top,e=d.suggestions;if(c+b>e.outerHeight()){e.scrollTop(e.scrollTop()+(c+b-e.outerHeight()))}if(b<0){e.scrollTop(e.scrollTop()+b)}}},_clear_cache:function(){var b=this;b._cached_results={};return true}});a.widget("pr.widget_dialog",a.pr.widget_meta,{options:{dialog_id:null,dialog_class:"",params:{},id:null,proxy:null,overlay_class:"overlay",_offset_top:"5%",_is_loaded:false,_rendered:function(c,b){}},_create:function(){this._super();this._override();this._render();this._listen();return this},_override:function(){if(this.options.dialog_id==null){this.options.dialog_id=this.options._widget_class+"-"+this.uuid}if(this.options.id==null){this.options.id=this.options.dialog_id.split("-").join("_")}},_render:function(){var b=this;b.dialog=a("<div />");b.dialog.addClass(b.options._widget_class).addClass(b.options.dialog_class).prop("id",b.options.dialog_id).appendTo(a("body")).hide();b.header=a("<header />");b.header.appendTo(b.dialog);b.title=a("<h3 />");b.title.addClass("title").appendTo(b.header);b.content=a("<section />");b.content.appendTo(b.dialog);b.footer=a("<footer />");b.footer.appendTo(b.dialog);b.actions=a("<div />");b.actions.addClass("actions row").appendTo(b.footer);if(!a("."+b.options.overlay_class).length){a("body").append('<div class="'+b.options.overlay_class+'" />')}b.overlay=a("."+b.options.overlay_class);b.overlay.hide()},_listen:function(){var b=this;b.overlay.on("click",function(c){if(b.options._is_open&&b.overlay.data("trigger")==b.options._widget_prefix){b.close()}});b.actions.on("click","a",function(f){var c=a(this).data("type"),d=a(this).data("action"),g=a(this).data("params");b._trigger("_"+c,null,{context:b,action:d,params:g});b._trigger("_"+c+"_"+b.options.id,null,{context:b,action:d,params:g});if(typeof d!=="undefined"){f.preventDefault();b._trigger("_"+c+"_"+d,null,{context:b,params:g});b._trigger("_"+c+"_"+d+"_".self.options.id,null,{context:b,params:g})}if(!a(this).data("manual")){b.close()}});b.content.on("scroll",function(f){f.preventDefault();var d=false,c=false;if(a(this).scrollTop()+a(this).innerHeight()>=a(this)[0].scrollHeight){c=true}if(a(this).scrollTop()==0){d=true}b._trigger("_content_scroll",null,{context:b,content:a(this),top:d,bottom:c});b._trigger("_content_scroll_"+b.options.id,null,{context:b,content:a(this),top:d,bottom:c})})},open:function(){var b=this;if(a.isEmptyObject(b.options.params)){return false}b._load().done(function(){b._position(true).done(function(){b._trigger("_before_open",null,{context:b});b._trigger("_before_open_"+b.options.id,null,{context:b});b._show().done(function(){b._trigger("_opened",null,{context:b,widget:b});b._trigger("_opened_"+b.options.id,null,{context:b})})})})},_load:function(){var b=this,g=b.options.params,f=a.Deferred();b._trigger("_before_load",null,{context:b,params:g});b._trigger("_before_load_"+b.options.id,null,{context:b,params:g});if("action" in g&&g.action.length){var e=a.extend(g,{pid:b.options._pid,params:b.options._params});var c=a.ajax({url:b.options.ajax_url,method:"post",dataType:"json",data:e});c.done(function(d){if("success" in d&&d.success){b._populate(d);if(b.options._is_loaded){b._trigger("_loaded",null,{context:b,data:d});b._trigger("_loaded_"+b.options.id,null,{context:b,data:d});f.resolve()}else{f.reject()}}else{f.reject()}});c.fail(function(){f.reject()})}else{b._populate(g);if(b.options._is_loaded){f.resolve()}else{f.reject()}}return f.promise()},_position:function(e){var b=this,c=a.Deferred();if(e){b.dialog.show().animate({top:"-150%"},0,function(){c.resolve()})}else{c.resolve()}return c.promise()},_populate:function(c){var b=this;if(c.length==0){return false}if("actions" in c&&c.actions.length){a.each(c.actions,function(e,f){if("type" in f&&f.type.length){var d=a("<a />");d.addClass("btn").addClass(f.type).data("type",f.type).appendTo(b.actions);if("icon" in f){d.append('<i class="fa '+f.icon+'"></i>')}if("label" in f){d.append("<span>"+f.label+"</span>")}if("class" in f){d.addClass(f["class"])}if("href" in f){d.prop("href",f.href)}if("action" in f){d.attr("data-action",f.action)}if("params" in f){d.attr("data-params",JSON.stringify(f.params))}if("manual" in f){d.data("manual",true)}}})}if("title" in c){b.title.html(c.title)}if("content" in c){b.content.html(c.content);b.options._is_loaded=true}},_show:function(){var b=this,c=a.Deferred();b.overlay.data("trigger",b.options._widget_prefix).fadeIn("fast",function(){b.dialog.animate({top:b.options._offset_top},"fast");b.options._is_open=true;c.resolve()});return c.promise()},close:function(){var b=this;b._trigger("_before_close",null,{context:b});b._trigger("_before_close_"+b.options.id,null,{context:b});a.when(b._hide()).done(function(){b.dialog.remove();b._trigger("_closed",null,{context:b});b._trigger("_closed_"+b.options.id,null,{context:b});b.destroy()})},_hide:function(){var b=this,c=a.Deferred();b.dialog.animate({top:"-120%"},"slow");b.overlay.data("trigger",null).fadeOut("fast",function(){c.resolve()});return c.promise()},destroy:function(){var b=this;b._super();b.dialog.remove()}});a.dialog=function(b){a("body").widget_dialog(b).widget_dialog("open")};a.widget("pr.widget_lightbox",a.pr.widget_meta,{options:{},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this},_render:function(){var c=this;c.lightbox=a("<div />");c.lightbox.addClass(c.options._widget_class).appendTo(a("body"));c.content=a("<div />");c.content.addClass("content").appendTo(c.lightbox);c.triggers=c.element.find("[data-lightbox]");a.each(c.triggers,function(k,j){a(j).data("index",k)});var b=a("body"),e="overlay",h=c.options._widget_class+"-prev",d=c.options._widget_class+"-next";if(!a("."+e).length){b.append('<div class="'+e+'" />')}c.overlay=a("."+e);c.overlay.hide();if(!a("#"+h).length){var g=a("<a />");g.addClass("btn btn-fixed btn-primary prev").attr("id",h).html('<i class="fa fa-chevron-left"></i>').appendTo(b)}if(!a("#"+d).length){var f=a("<a />");f.addClass("btn btn-fixed btn-primary next").attr("id",d).html('<i class="fa fa-chevron-right"></i>').appendTo(b)}c.prev=a("#"+h);c.next=a("#"+d)},_listen:function(){var b=this;b.triggers.on("click",function(c){c.preventDefault();b._current=a(this);if(!b._is_open){b._open().then(function(){b._is_open=true})}});b.overlay.on("click",function(c){if(b.overlay.data("trigger")==b.uuid){b._close().then(function(){b._is_open=false})}});b.next.on("click",function(c){c.preventDefault();if(b._is_open&&!a(this).data("disabled")&&a(this).data("trigger")==b.uuid){b._switch(1)}});b.prev.on("click",function(c){c.preventDefault();if(b._is_open&&!a(this).data("disabled")&&a(this).data("trigger")==b.uuid){b._switch(-1)}})},_open:function(){var b=this,c=a.Deferred();b._load().done(function(e){var d=parseInt(b._current.data("index"));b._update(d);b.overlay.fadeIn("fast").data("trigger",b.uuid);b.next.data("trigger",b.uuid);if(!b.next.data("disabled")){b.next.animate({right:"5%"})}b.prev.data("trigger",b.uuid);if(!b.prev.data("disabled")){b.prev.animate({left:"5%"})}b.content.append(e);b.lightbox.animate({top:"50%"},"fast",function(){c.resolve()})});return c.promise()},_close:function(){var b=this,c=a.Deferred();b.overlay.fadeOut("slow").data("trigger",null);b.next.data("trigger",null).animate({right:"-20%"},"fast");b.prev.data("trigger",null).animate({left:"-20%"},"fast");b.lightbox.animate({top:"-150%"},"slow",function(){b.content.empty();c.resolve()});return c.promise()},_load:function(){var b=this,f=a.Deferred(),e=b._current.data("lightbox"),c=null;if(a.isEmptyObject(e)){f.reject()}switch(e.type){case"image":c=a("<img />");c.attr("src",e.src);break;case"youtube":c=a("<iframe />");c.attr("src",e.src).css({width:"80vw",height:"90vh"});break}if(c!=null){f.resolve(c)}else{f.reject()}return f.promise()},_switch:function(e){var b=this,c=parseInt(b._current.data("index"))+e,d;if(c>=0&&c<b.triggers.length){b._current=b.triggers.filter(function(){return a(this).data("index")==c});b._update(c);b._load().done(function(f){b._adjust(f).done(function(j,g){var h=b.lightbox.find(".content");h.animate({opacity:0},"fast",function(){h.animate({height:g,width:j},"fast",function(){h.html(f);h.animate({opacity:1},"fast",function(){h.css({width:"auto",height:"auto"})})})})})})}},_adjust:function(f){var c=this,g=a.Deferred();var h=c.lightbox.clone();h.addClass("clone").appendTo(a("body")).find(".content").empty().append(f);var e=h.width(),b=h.height();h.remove();g.resolve(e,b);return g.promise()},_update:function(c){var b=this,e=c-1>=0,d=c+1<b.triggers.length;if(d){b.next.removeClass("disabled").data("disabled",false).animate({right:"5%"},"fast")}else{b.next.addClass("disabled").data("disabled",true).animate({right:"-5%"},"fast")}if(e){b.prev.removeClass("disabled").data("disabled",false).animate({left:"5%"},"fast")}else{b.prev.addClass("disabled").data("disabled",true).animate({left:"-5%"},"fast")}}});a.widget("pr.widget_lightbox_old",a.pr.widget_meta,{options:{},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this;b.lightbox=null;b.triggers=b.element.find("[data-lightbox]");a.each(b.triggers,function(d,c){a(c).data("index",d)})},_render:function(){var b=this;b.lightbox=a("<div />");b.lightbox.addClass(b.options._widget_class).appendTo(a("body")).hide();b.header=a("<header />");b.header.appendTo(b.lightbox);b.title=a("<h3 />");b.title.addClass("title").appendTo(b.header);b.content=a("<section />");b.content.appendTo(b.lightbox);b.actions=a("<div />");b.actions.addClass("actions").appendTo(b.lightbox);b.prev=a("<a />");b.prev.addClass("btn btn-fixed btn-primary prev").html('<i class="fa fa-chevron-left"></i>').appendTo(b.actions);b.next=a("<a />");b.next.addClass("btn btn-fixed btn-primary next").html('<i class="fa fa-chevron-right"></i>').appendTo(b.actions);var c="overlay";if(!a("."+c).length){a("body").append('<div class="'+c+'" />')}b.overlay=a("."+c);b.overlay.hide()},_listen:function(){var b=this;b.triggers.on("click",function(c){c.preventDefault();b._current=a(this);if(!b._is_open){b.open()}});b.overlay.on("click",function(c){if(b._is_open&&b.overlay.data("trigger")==b.options._widget_name){b.close()}});b.next.on("click",function(c){c.preventDefault();if(b._is_open){b._switch("next")}});b.prev.on("click",function(c){c.preventDefault();if(b._is_open){b._switch("prev")}})},_switch:function(d){var b=this,e=0;if(d=="next"){e=1}if(d=="prev"){e=-1}var c=parseInt(b._current.data("index"))+e;if(c>=0&&c<=b.triggers.length){b._current=b.triggers.filter(function(){return a(this).data("index")==c});b._load().then(function(){b._position();b._update()})}},open:function(){var b=this;b._load().done(function(){b._position(true).done(function(){b._trigger("_before_open",null,{context:b});b._trigger("_before_open_"+b.options.id,null,{context:b});b._update();b._show().done(function(){b._trigger("_opened",null,{context:b});b._trigger("_opened_"+b.options.id,null,{context:b})})})})},_load:function(){var b=this,f=a.Deferred(),e=b._current.data("lightbox");switch(e.type){case"image":b.content.empty();var c=a("<img />");c.appendTo(b.content).attr("src",e.src);break}c.css("opacity",0).on("load",function(){a(this).animate({opacity:1},"slow");f.resolve()});return f.promise()},_position:function(e){var b=this,c=a.Deferred();b.lightbox.show();return c.promise()},_show:function(){var b=this,c=a.Deferred();b.overlay.data("trigger",b.options._widget_name).fadeIn("fast",function(){b.lightbox.animate({top:"50%"},"fast");b._is_open=true;c.resolve()});return c.promise()},close:function(){var b=this;b._trigger("_before_close",null,{context:b});b._trigger("_before_close_"+b.options.id,null,{context:b});a.when(b._hide()).done(function(){b._is_open=false;b._trigger("_closed",null,{context:b});b._trigger("_closed_"+b.options.id,null,{context:b})})},_hide:function(){var b=this,c=a.Deferred();b.lightbox.animate({top:"-"+(b.lightbox.outerHeight()+100)+"px"},"fast",function(){b.overlay.fadeOut("fast").data("trigger",null);c.resolve()});return c.promise()},_update:function(){var b=this,c=parseInt(b._current.data("index"));b.prev.show();b.next.show();if(c==0){b.prev.hide()}if(c+1==b.triggers.length){b.next.hide()}}});a.widget("pr.widget_form",a.pr.widget_meta,{options:{ajax_action:null,ajax_datatype:"json",ajax_method:"post",delay:1,clear:false,submit_btn:'button[type="submit"]',message_class:"message",error_class:"status",invalid_input_class:"invalid",_is_auto:false,_widget_prefix:"pr-widget-form"},_create:function(){this._super();this.form=this.element;this.submit_btn=this.element.find(this.options.submit_btn);this._override();this._render();this._bind_events()},_override:function(){var b=this;if(typeof b.form.data("ajax-action")!=="undefined"){b.options.ajax_action=b.form.data("ajax-action")}if(typeof b.form.data("auto")!=="undefined"&&b.form.data("auto")){b.options._is_auto=true}if(typeof b.form.data("reload")!=="undefined"&&b.form.data("reload")){b.options.reload=true}if(typeof b.form.data("refresh")!=="undefined"&&b.form.data("refresh")){b.options.reload=true}if(typeof b.form.data("delay")!=="undefined"){b.options.delay=parseInt(b.form.data("delay"))}if(typeof b.form.data("clear")!=="undefined"){b.options.clear=Boolean(b.form.data("clear"))}},_render:function(){var b=this;b.form.addClass(b.options._widget_class).find(".antispam").css({display:"none"});b.submit_btn.addClass(b.options._widget_class+"-submit");b._trigger("_rendered",null,{widget:b})},_bind_events:function(){var b=this;b.form.on("submit",{context:this},this._on_submit_form);if(b.options._is_auto){b.form.on("change",":input",function(){b.form.submit()})}},_on_submit_form:function(c){c.preventDefault();var b=c.data.context;b._trigger("_before_submit",null,{widget:b});if(b.form.data("disabled")){return false}b._submit()},_submit:function(){var b=this;b.form.data("disabled",true).addClass("loading");b._cleanup();if(!b.options.ajax_url){return false}var d=b.form.serialize();if(!b.form.find(':input[name="pid"]').length){d+="&pid="+b.options._pid}if(b.options.ajax_action){d+="&action="+b.options.ajax_action}var c=a.ajax({url:this.options.ajax_url,method:this.options.ajax_method,dataType:this.options.ajax_datatype,data:d});b._trigger("_submit",null,{context:b,widget:b});c.done(function(e){b._on_submit_done(e)});c.fail(function(e){b._trigger("_submit_fail",null,{context:b,data:e});b._trigger("_submit_error",null,{widget:b,data:e})});c.always(function(e){b.form.data("disabled",false).removeClass("loading")})},_on_submit_done:function(d){var c=this,b="success";if("status" in d&&d.status=="success"){d.success=true}if(!d.success){b="error";if("errors" in d){c._populate_errors(d.errors)}}if("redirect" in d){setTimeout(function(){document.location.href=d.redirect},c.options.delay)}if(d.success&&c.options.reload){setTimeout(function(){document.location.reload()},c.options.delay)}if(d.success&&c.options.clear){c.form.find(":input:not(:hidden)").val("")}if("message" in d){a.status(b,d.message,null,true)}c._trigger("_submit_"+b,null,{context:c,data:d,widget:c})},cleanup:function(){return this._cleanup()},_cleanup:function(){var b=this,c=b.form.find("."+b.options.message_class+", ."+b.options.error_class);c.remove();b.form.find("."+b.options.invalid_input_class).removeClass(b.options.invalid_input_class)},populate_errors:function(b){return this._populate_errors(b)},_populate_errors:function(c){var b=this;form=this.form;a.each(c,function(f,g){var d=form.find(':input[name="'+f+'"], :input[name="'+f+'[]"]').closest(".input"),e=a("<p />");d.closest(".form-element").addClass("invalid");e.addClass(b.options.error_class).html(g).hide().insertAfter(d).slideIn("fast")})},submit:function(){this._submit()}});a.widget("pr.widget_clonable",a.pr.widget_meta,{options:{},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this},_render:function(){var b=this;b.element.addClass(b.options._widget_class).prop("id",this.options._widget_class+"-"+this.uuid);b.list=a("<div />");b.list.addClass(b.options._widget_class+"-items");b.element.children().each(function(e){var d=a(this);var c=a("<div />");c.addClass(b.options._widget_class+"-item-controls row").append('<a class="'+b.options._widget_class+'-control sort"><span>'+(e+1)+"</span></a>").append('<a class="'+b.options._widget_class+'-control delete btn btn-fixed btn-link btn-red"><i class="fa fa-times"></i></a>');var g=a("<div />");g.addClass(b.options._widget_class+"-item-content").append(d);var f=a("<div />");f.addClass(b.options._widget_class+"-item").append(c).append(g).appendTo(b.list)});b.list.appendTo(b.element).sortable({handle:"."+b.options._widget_class+"-item-controls",placeholder:"sortable-placeholder",forceHelperSize:true,forcePlaceholderSize:true,tolerance:"pointer",distance:2,opacity:0.8});b.list.children().each(function(c){a(this).find(":input:not(button)").each(function(){var d=a(this).prop("name"),g=d.split(/[[\]]{1,2}/).filter(function(h){return h!==""});var e=g[0];g.splice(0,1);g.splice(0,1);var f=e+"[%index%]["+g.join("][")+"]";if(d.endsWith("[]")){f=f+"[]"}a(this).data("name-template",f)});a(this).find(".sort").find("span").text((c+1))});b.model=b.list.children().first().clone(true).off();b.add=a("<a />");b.add.html('<i class="fa fa-plus"></i>').addClass(b.options._widget_class+"-add btn btn-link btn-fixed").prop("id",b.options._widget_class+"-more-"+b.uuid).appendTo(b.element).wrap('<div class="'+b.options._widget_class+'-footer"></div>');b._trigger("_rendered",null,{context:b})},_listen:function(){var b=this;b.add.on("click",function(d){if(b.options.max_length){length=b.element.find("."+b.options.item_class).length;if(length>=b.options.max_length){return false}}var f=b._trigger("_before_add",null,{context:b});if(f!==false){b._add_item()}});b.element.on("click",".delete",function(d){d.preventDefault();var c=a(this).closest("."+b.options._widget_class+"-item");b._delete_item(c).then(function(){if(b.list.children().length<1){if(b._trigger("_before_recreate",null,{context:b})!==false){b._add_item()}}})});b.element.on("sortupdate",function(c){b._update()});b.element.on("sort",function(g,f){var d=f.item.outerWidth(),c=f.item.outerHeight();f.placeholder.css({width:d,height:c})})},add_item:function(c){var b=this,e=a.Deferred();b._add_item(c).then(function(){e.resolve()});return e.promise()},_add_item:function(c){var b=this,e=a.Deferred(),f=b.model.clone(true).off();f.hide().appendTo(b.list);if(typeof c!=="undefined"&&a.isPlainObject(c)){a.each(c,function(d,g){f.attr(d,g)})}b._trigger("_item_added",null,{widget:b,item:f});b._update();f.slideIn("fast",function(){b._clear_values(f);b._trigger("_reset_widgets",null,{context:b,element:f});e.resolve()});b._trigger("_add",null,{context:b});a.scroll_to(a(f));return e.promise()},delete_item:function(c){var b=this,e=a.Deferred();b._delete_item(c).then(function(){e.resolve()});return e.promise()},_delete_item:function(c){var b=this,e=a.Deferred();a(c).slideOut("fast",function(){a(this).remove();b._update();e.resolve()});b._trigger("_delete",null,{context:b});return e.promise()},_clear_values:function(b){a(b).find(":input").not(":button, :submit, :reset, :hidden, :checkbox").val("");a(b).find(":input").not(":button, :submit, :reset").removeAttr("checked").removeAttr("selected").change().blur();a(b).find("select").prop("selectedIndex",0)},update:function(){var b=this;b._update()},_update:function(){var b=this;b.list.children().each(function(c){a(this).find(":input:not(button)").each(function(d){var e=a(this).data("name-template").replace("%index%",c),f=e.endsWith("[]")?e+"-"+d:e;a(this).prop("name",e).prop("id",f).next("label").prop("for",f)});a(this).find(".sort").find("span").text((c+1))})}});a.widget("pr.widget_select",a.pr.widget_meta,{options:{text:{check_all:"Выбрать все",uncheck_all:"Отменить все",none_selected:"Выберите опцию",selected:"Выбрано #"},menu_height:160,selected_names:1,multiple:false,disabled:false,_is_open:false,_use_native:false},_create:function(){this._super();this._is_open=false;this._is_native=false;this._override_options();if(this._is_native){this.element.show()}else{this.element.hide();this._create_ui();this._bind_events();this._refresh(true)}},_override_options:function(){if(!this.options.multiple){this.options.multiple=this.element.is("[multiple]")?true:false}if(typeof this.element.attr("disabled")!=="undefined"){this.options.disabled=true}if(typeof this.element.data("selected-names")!=="undefined"&&a.isNumeric(this.element.data("selected-names"))){this.options.selected_names=this.element.data("selected-names")}if(typeof Modernizr=="object"){if(Modernizr.touch){this._is_native=true}}},_create_ui:function(){var b=this;b.select_label=a("<span>"+b.options.text.none_selected+"</span>");b.select=a("<div />");b.select.prop("id",b.options._widget_class+"-"+b.uuid).addClass(b.options._widget_class).insertAfter(b.element);b.input=a("<div />");b.input.addClass(b.options._widget_class+"-input").append(b.select_label).append('<i class="fa fa-caret-down"></i>').css("opacity",(b.options.disabled?".5":"1")).appendTo(b.select);b.menu=a("<div />");b.menu.addClass(b.options._widget_class+"-menu").addClass((b.options.multiple?"multiple":"")).appendTo(b.select).hide();b.list=a("<ul />");b.list.addClass(b.options._widget_class+"-list").css({"max-height":this.options.menu_height}).appendTo(b.menu)},_bind_events:function(){var b=this;a(document).on("mouseup",function(c){if(b._is_open&&c.target!==b.select[0]&&c.target!==b.menu[0]&&!a.contains(b.menu[0],c.target)&&!a.contains(b.select[0],c.target)){b._close()}});b.input.on("click",{context:b},b._on_click_input);b.menu.on("change","input",{context:b},b._on_select_multiple);b.menu.on("click","a[data-value]",{context:b},b._on_select_single);b.element.on("change",{context:b},function(){b._refresh(true)})},_on_click_input:function(c){var b=c.data.context;if(b.options.disabled){return false}if(b._is_open){b._close()}else{b._open()}},_on_select_multiple:function(f){var b=f.data.context,d=this.value,c=this.checked;if(c){a(this).closest("li").addClass("selected")}else{a(this).closest("li").removeClass("selected")}b.element.find("option").each(function(){if(this.value===d){this.selected=c}});b.element.trigger("change");b._update()},_on_select_single:function(d){if(a(this).closest("li").hasClass("disabled")){return}var b=d.data.context,c=a(this).data("value");b.menu.find("li.selected").removeClass("selected");a(this).closest("li").addClass("selected");b._update();b._close();b.element.val(c).trigger("change")},_open:function(){var b=this;if(b._trigger("_before_open")===false||b._is_open){return}b.menu.show();b.select.addClass("active");b._is_open=true;b._trigger("_open",null,{context:b});b.element.trigger("focusin")},_close:function(){var b=this;if(b._trigger("_before_close")===false){return}b.menu.hide();b.select.removeClass("active");b._is_open=false;b._trigger("close");b.element.trigger("focusout")},_refresh:function(e){var c=this,d="",b=[];c.element.find("option").each(function(k){var n=this.parentNode,o=this.innerHTML,m=this.value,g=c.options._widget_class+"-option-"+c.uuid+"-"+k,f=this.disabled,j=this.selected,h=[c.options._widget_class+"-option"],l;if(n.tagName==="OPTGROUP"){l=n.getAttribute("label");if(a.inArray(l,b)===-1){d+='<li class="'+c.options._widget_class+'-optgroup">';d+=l;d+="</li>";b.push(l)}}if(f){h.push("disabled")}if(j){h.push("selected")}d+='<li class="'+h.join(" ")+'">';if(c.options.multiple){d+='<label for="'+g+'">';d+='<input type="checkbox" id="'+g+'" value="'+m+'"'+(j?' checked="checked"':"")+(f?' disabled="disabled"':"")+"/>";d+="<span>"+o+"</span>";d+="</label>"}else{d+='<a data-value="'+m+'">'+o+"</a>"}d+="</li>"});c.list.html(d);if(c.options.multiple){c.labels=c.menu.find("label");c.inputs=c.labels.children("input")}if(e){c.select[0]["default"]=this._update()}else{this._trigger("refresh")}},_update:function(){var b=this,e;if(b.options.multiple){var d=b.inputs.filter(":checked"),c=d.length;if(c===0){e=b.options.text.none_selected}else{if(/\d/.test(b.options.selected_names)&&b.options.selected_names>0&&c<=b.options.selected_names){e=d.map(function(){return a(this).next().html()}).get().join(", ")}else{e=b.options.text.selected.replace("#",c).replace("#",b.inputs.length)}}}else{e=b.menu.find("li.selected").find("a").text()}b.select_label.text(e);return e},refresh:function(){this._refresh()}});a.widget("pr.widget_table_scrollable",a.pr.widget_meta,{options:{},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this},_render:function(){var b=this;b.table=b.element;b.table.addClass(b.options._widget_class).find("thead").find("th").prop("scope","col");b.outer=a("<div />");b.outer.addClass(b.options._widget_class+"-outer").insertBefore(b.table);b.inner=a("<div />");b.inner.addClass(b.options._widget_class+"-inner").appendTo(b.outer);b.table.appendTo(b.inner);b.clone=b.table.clone(true);b.clone.addClass("clone").appendTo(b.outer)},_listen:function(){var b=this}});a.widget("pr.widget_sparkline",a.pr.widget_meta,{options:{data:[],conditional:false},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this},_render:function(){var b=this},_listen:function(){var b=this},draw:function(c){var b=this;b._draw(c)},_draw:function(h){var q=this,b=q.element.width(),o=q.element.height(),h=typeof h!=="undefined"?h:q.options.data,m=Math.max.apply(null,h),f=Math.min.apply(null,h),k=h[0],n=h[h.length-1],d=q.options.conditional?(n>k?"color-green":"color-red"):"";q.element.find("svg").remove();var l=function(c){var t=o/(m-f);return o-(t*(c-f))};var j=a(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr({width:b,height:o,transform:"translate(0,1)","class":d}).appendTo(q.element).hide().fadeIn("fast");var e=Math.round(b/(h.length-1));var p="M0 "+l(h[0]).toFixed(2);for(var g=0;g<h.length;g++){p+=" L "+(g*e)+" "+(l(h[g]).toFixed(2))}var r=a(document.createElementNS("http://www.w3.org/2000/svg","path")).attr({d:p,fill:"none"}).appendTo(j)}});a.widget("pr.ui_lazy_load",a.pr.widget_meta,{_create:function(){this._super();this._listen()},_listen:function(){var b=this;a(window).on("load scroll resize",function(){b._decide()})},_decide:function(){var e=this,g=[];var d=window.pageYOffset,b=d+a(window).height(),f=e.element.offset().top,c=f+e.element.outerHeight();if(f<b&&c>d){e._trigger("_ready",null,{context:e})}}});a.widget("pr.ui_dropdown_button",a.pr.widget_meta,{options:{},_create:function(){this._super();this._override();this._render();this._listen()},_override:function(){var b=this},_render:function(){var b=this;b.trigger=b.element.find("button.trigger");b.target=a(b.trigger.data("target"))},_listen:function(){var b=this;a(window).on("click",function(){b.element.removeClass("active")});b.target.on("click",function(c){c.stopPropagation()});b.trigger.on("click",function(c){c.preventDefault();c.stopPropagation();if(b.element.hasClass("active")){b.element.removeClass("active")}else{b.element.addClass("active");b.target.position({my:"left top",at:"left bottom",of:b.trigger,collision:"flip"})}})}});a.fn.input_value=function(d){var c=a(this);if(c.is("select")){c.find("option").each(function(){if(a(this).prop("value")==d){a(this).prop("selected",true)}})}else{if(c.is(":checkbox")){var b=a.isArray(d)?d:[d];c.prop("checked",false);a.each(b,function(e,f){c.each(function(){if(a(this).val()==f){a(this).prop("checked",true)}})})}else{c.val(d)}}c.change()}})(jQuery);jQuery(document).ready(function(b){b.fn.widget_exists=function(f,e){e=typeof e!=="undefined"?e:"pr";return typeof b(this).data(e+"-"+f)!=="undefined"};b.get_device=function(){var e=b("body");if(!e.widget_exists("widget_device")){e.widget_device()}return e.widget_device("get_device")};b.is_device=function(f,g){var e=b("body");if(!e.widget_exists("widget_device")){e.widget_device()}return e.widget_device("is_device",f,g)};b.status=function(e,h,g,j){var f=b("body");if(!f.data("widget_status")){f.widget_status()}f.widget_status("queue",e,h,g,j)};b.message=function(h,f,g){var e={success:"fa-check",error:"fa-times",warning:"fa-exclamation",info:"fa-info"};g=typeof g!=="undefined"?g:e[f];return b('<div class="message row '+f+'"><div class="icon"><i class="fa '+g+'"></i></div><div class="text">'+h+"</div></div>")};b.scroll_to=function(e){var f=b("body");if(!f.data("widget_scroll")){f.widget_scroll()}f.widget_scroll("scroll",e)};b.transliterate=function(f){var e={"Ё":"YO","Й":"I","Ц":"TS","У":"U","К":"K","Е":"E","Н":"N","Г":"G","Ш":"SH","Щ":"SCH","З":"Z","Х":"H","Ъ":"'","ё":"yo","й":"i","ц":"ts","у":"u","к":"k","е":"e","н":"n","г":"g","ш":"sh","щ":"sch","з":"z","х":"h","ъ":"'","Ф":"F","Ы":"I","В":"V","А":"a","П":"P","Р":"R","О":"O","Л":"L","Д":"D","Ж":"ZH","Э":"E","ф":"f","ы":"i","в":"v","а":"a","п":"p","р":"r","о":"o","л":"l","д":"d","ж":"zh","э":"e","Я":"Ya","Ч":"CH","С":"S","М":"M","И":"I","Т":"T","Ь":"'","Б":"B","Ю":"YU","я":"ya","ч":"ch","с":"s","м":"m","и":"i","т":"t","ь":"'","б":"b","ю":"yu"};return f.split("").map(function(g){return e[g]||g}).join("")};b.check_json=function(f){try{JSON.parse(f)}catch(g){return false}return true};b.gtm_event=function(g,e){var f={event:g};f=b.isPlainObject(e)?b.extend(f,e):f;window.dataLayer=window.dataLayer||[];window.dataLayer.push(f)};b.fn.get_attributes=function(){var f=b(this),e={};b.each(f[0].attributes,function(){e[this.name]=this.value});return e};b.fn.set_attributes=function(f,e){var g=b(this);if(!b.isEmptyObject(f)){b.each(f,function(h,j){if(b.isArray(e)&&b.inArray(h,e)){}else{g.prop(h,j)}})}};b.fn.slideIn=function(f,g){var e=this;e.css({opacity:0}).stop().slideDown(f,function(){e.animate({opacity:1},f,function(){if(typeof g==="function"){g.apply(e)}})})};b.fn.slideOut=function(f,g){var e=this;e.stop().animate({opacity:0},f,function(){e.slideUp(f,function(){if(typeof g==="function"){g.apply(e)}})})};var d={date:{human:date_format,robot:"YYYY-MM-DD"},time:{human:time_format,robot:"HH:mm"},datetime:{human:date_format+" "+time_format}};var a=typeof LocaleCurrent!=="undefined"?LocaleCurrent:"ru",c={zh:"zh-cn"};a=a in c?c[a]:a;moment.locale(a);b("[data-date]").each(function(){let timestamp=moment.parseZone(b(this).data("date"));timestamp.utc();timestamp.local();b(this).prop("title",timestamp.format(d.datetime.human)).text(timestamp.fromNow())});b.date_html=function(e){var f=moment(e),g='<span class="date" data-date="'+f.format(d.date.human)+'">'+f.fromNow()+"</span>";return g};b(".date.countdown").each(function(){var e=b(this),g=moment(new Date()),j=e.find("[data-date-till]").data("date-till");if(typeof j==="undefined"){return false}j=moment(j);var h=j.diff(g,"days");var f="green";if(h<3){f="red"}if(h<0){f="yellow"}e.append('<span class="difference color-'+f+'">('+j.fromNow()+")</span>")});NumberFormat=function(e){let d={upperExp:10,lowerExp:-10,notation:"auto",precision:3};if(e>1){d.notation="fixed";d.precision=5}if(e>1000){d.precision=2}if(e%1==0){d.precision=0}return math.format(e,d)};b.get_preferences=function(e){let preferences=localStorage.getItem("preferences");preferences=preferences?b.parseJSON(preferences):{};if(typeof e!=="undefined"){return e in preferences?preferences[e]:null}return preferences};b.set_preferences=function(e){let current_preferences=localStorage.getItem("preferences");current_preferences=current_preferences?b.parseJSON(current_preferences):{};e=b.extend(current_preferences,e);localStorage.setItem("preferences",JSON.stringify(e));b("body").trigger("preferences_updated",e);return true}});